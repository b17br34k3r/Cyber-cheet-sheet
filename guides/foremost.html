<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Foremost Guide - Cybersecurity Cheat Sheet</title>
    <link rel="stylesheet" href="../styles.css">
    <link rel="stylesheet" href="../guide-styles.css">
</head>
<body>
    <div class="guide-container">
        <header class="guide-header">
            <h1>Foremost: File Carving Tool</h1>
            <p>Master Data Recovery and File Extraction</p>
            <a href="../index.html" class="back-link">&larr; Back to Cheat Sheet</a>
        </header>

        <main class="guide-content">
            <section id="introduction">
                <h2>What is Foremost?</h2>
                <p>Foremost is a console program to recover files based on their headers, footers, and internal data structures. This process is commonly referred to as data carving. Foremost can work on image files, such as those generated by dd, Safeback, Encase, etc., or directly on a drive. The headers and footers can be specified by a configuration file or you can use command line switches to specify built-in file types. These built-in types look at the data structures of a given file format allowing for more reliable and faster recovery.</p>
            </section>

            <section id="installation">
                <h2>Installation & Setup</h2>
                <div class="command-block">
                    <h3>Linux Installation</h3>
                    <pre><code># Ubuntu/Debian
sudo apt update
sudo apt install foremost

# CentOS/RHEL/Fedora
sudo yum install foremost
# or
sudo dnf install foremost

# Arch Linux
sudo pacman -S foremost

# From source
wget http://foremost.sourceforge.net/pkg/foremost-1.5.7.tar.gz
tar -xzf foremost-1.5.7.tar.gz
cd foremost-1.5.7
make
sudo make install</code></pre>
                </div>
                <div class="command-block">
                    <h3>Windows Installation</h3>
                    <pre><code># Download Windows binary from:
# http://foremost.sourceforge.net/

# Or use Windows Subsystem for Linux (WSL)
# Install Ubuntu on WSL, then:
sudo apt install foremost

# Alternative: Use in Kali Linux VM
# Foremost comes pre-installed in Kali Linux</code></pre>
                </div>
                <div class="command-block">
                    <h3>macOS Installation</h3>
                    <pre><code># Using Homebrew
brew install foremost

# Using MacPorts
sudo port install foremost

# From source (requires Xcode command line tools)
xcode-select --install
wget http://foremost.sourceforge.net/pkg/foremost-1.5.7.tar.gz
tar -xzf foremost-1.5.7.tar.gz
cd foremost-1.5.7
make
sudo make install</code></pre>
                </div>
                <div class="command-block">
                    <h3>Verification</h3>
                    <pre><code># Check installation
foremost -V

# Display help
foremost -h

# Check configuration file location
ls /etc/foremost.conf
ls /usr/local/etc/foremost.conf</code></pre>
                </div>
            </section>

            <section id="basic-usage">
                <h2>Basic Usage</h2>
                <div class="command-block">
                    <h3>Simple File Carving</h3>
                    <pre><code># Basic carving with default file types
foremost -i input_image.dd -o output_directory

# Carve specific file types
foremost -t jpg,png,gif -i image.dd -o carved_images/

# Carve from physical device (requires root)
sudo foremost -i /dev/sdb1 -o recovered_files/

# Verbose output
foremost -v -i image.dd -o output/

# Carve all supported file types
foremost -a -i image.dd -o all_files/</code></pre>
                </div>
                <div class="command-block">
                    <h3>Supported File Types</h3>
                    <pre><code># Built-in file types:
# jpg, gif, png, bmp - Image formats
# avi, exe, mpg, wav - Multimedia and executables
# wmv, mov, pdf, ole - Documents and media
# doc, zip, rar, htm - Archives and documents
# cpp, all - Source code and all types

# Display supported types
foremost -h | grep -A 20 "File types"

# Common usage examples:
foremost -t jpg,png,gif -i disk.dd -o images/
foremost -t pdf,doc,xls -i disk.dd -o documents/
foremost -t zip,rar,7z -i disk.dd -o archives/
foremost -t exe,dll -i disk.dd -o executables/</code></pre>
                </div>
                <div class="command-block">
                    <h3>Output Structure</h3>
                    <pre><code># Foremost creates organized output:
output_directory/
├── audit.txt          # Summary of recovery operation
├── jpg/              # Recovered JPEG files
│   ├── 00000001.jpg
│   ├── 00000002.jpg
│   └── ...
├── png/              # Recovered PNG files
│   ├── 00000001.png
│   └── ...
└── pdf/              # Recovered PDF files
    ├── 00000001.pdf
    └── ...</code></pre>
                </div>
            </section>

            <section id="advanced-options">
                <h2>Advanced Options</h2>
                <div class="command-block">
                    <h3>Configuration File Usage</h3>
                    <pre><code># Use custom configuration file
foremost -c custom_foremost.conf -i image.dd -o output/

# View default configuration
cat /etc/foremost.conf

# Example custom configuration entry:
# jpg    y    65536    \xff\xd8\xff\xe0\x00\x10    \xff\xd9

# Configuration format:
# type   case_sensitive   max_size   header   footer</code></pre>
                </div>
                <div class="command-block">
                    <h3>Size and Boundary Options</h3>
                    <pre><code># Set maximum file size (in bytes)
foremost -s 1048576 -i image.dd -o output/  # 1MB max

# Skip first N bytes
foremost -b 512 -i image.dd -o output/

# Process only N bytes
foremost -k 1073741824 -i image.dd -o output/  # Process 1GB

# Combine options
foremost -b 1024 -k 1048576 -s 65536 -i image.dd -o output/</code></pre>
                </div>
                <div class="command-block">
                    <h3>Quality and Performance Options</h3>
                    <pre><code># Enable indirect block detection (better quality)
foremost -d -i image.dd -o output/

# Quiet mode (suppress output)
foremost -q -i image.dd -o output/

# Write only complete files
foremost -w -i image.dd -o output/

# Combine for best results
foremost -d -w -v -i image.dd -o high_quality_output/</code></pre>
                </div>
            </section>

            <section id="file-type-specific">
                <h2>File Type-Specific Carving</h2>
                <div class="command-block">
                    <h3>Image File Recovery</h3>
                    <pre><code># Recover common image formats
foremost -t jpg,png,gif,bmp -i disk.dd -o images/

# High-quality image recovery
foremost -d -w -t jpg,png -i disk.dd -o quality_images/

# Recover RAW camera formats (if configured)
foremost -c camera_formats.conf -i memory_card.dd -o raw_photos/

# Example camera format config entry:
# cr2    n    33554432    CR\x02\x00    \xff\xd9</code></pre>
                </div>
                <div class="command-block">
                    <h3>Document Recovery</h3>
                    <pre><code># Recover office documents
foremost -t doc,pdf,xls,ppt -i disk.dd -o documents/

# Recover text and web files
foremost -t htm,txt -i disk.dd -o text_files/

# Custom document types
foremost -c office_formats.conf -i disk.dd -o office_docs/

# Example Office format entries:
# docx   n    104857600   PK\x03\x04\x14\x00\x06\x00   
# xlsx   n    104857600   PK\x03\x04\x14\x00\x06\x00</code></pre>
                </div>
                <div class="command-block">
                    <h3>Multimedia Recovery</h3>
                    <pre><code># Recover video files
foremost -t avi,mov,mp4,wmv -i disk.dd -o videos/

# Recover audio files
foremost -t wav,mp3,flac -i disk.dd -o audio/

# Recover all multimedia
foremost -t avi,mov,mp4,wmv,wav,mp3,flac,jpg,png -i disk.dd -o multimedia/

# Large file recovery (for videos)
foremost -s 1073741824 -t avi,mov,mp4 -i disk.dd -o large_videos/</code></pre>
                </div>
            </section>

            <section id="custom-configurations">
                <h2>Custom Configurations</h2>
                <div class="command-block">
                    <h3>Creating Custom Config Files</h3>
                    <pre><code># Example custom configuration file
cat > custom_foremost.conf << 'EOF'
# Custom Foremost Configuration
# Format: type case_sensitive max_size header footer

# Standard formats
jpg    y    20971520    \xff\xd8\xff\xe0\x00\x10    \xff\xd9
png    y    20971520    \x89\x50\x4e\x47\x0d\x0a\x1a\x0a    \x49\x45\x4e\x44\xae\x42\x60\x82
pdf    y    104857600   \x25\x50\x44\x46    \x25\x25\x45\x4f\x46

# Microsoft Office formats
doc    n    104857600   \xd0\xcf\x11\xe0\xa1\xb1\x1a\xe1
xls    n    104857600   \xd0\xcf\x11\xe0\xa1\xb1\x1a\xe1
ppt    n    104857600   \xd0\xcf\x11\xe0\xa1\xb1\x1a\xe1

# Archive formats
zip    n    1073741824  \x50\x4b\x03\x04
rar    n    1073741824  \x52\x61\x72\x21\x1a\x07\x00

# Executable formats
exe    n    104857600   \x4d\x5a
EOF

# Use custom configuration
foremost -c custom_foremost.conf -i image.dd -o custom_output/</code></pre>
                </div>
                <div class="command-block">
                    <h3>Specialized Recovery Configs</h3>
                    <pre><code># Database file recovery
cat > database_recovery.conf << 'EOF'
# Database file formats
sqlite n    1073741824  \x53\x51\x4c\x69\x74\x65\x20\x66\x6f\x72\x6d\x61\x74\x20\x33\x00
mdb    n    1073741824  \x00\x01\x00\x00\x53\x74\x61\x6e\x64\x61\x72\x64\x20\x4a\x65\x74\x20\x44\x42
EOF

# Email file recovery
cat > email_recovery.conf << 'EOF'
# Email file formats
pst    n    2147483648  \x21\x42\x44\x4e
ost    n    2147483648  \x21\x42\x44\x4e
eml    n    10485760    \x52\x65\x63\x65\x69\x76\x65\x64\x3a
EOF

# Use specialized configs
foremost -c database_recovery.conf -i disk.dd -o databases/
foremost -c email_recovery.conf -i disk.dd -o emails/</code></pre>
                </div>
            </section>

            <section id="forensic-workflows">
                <h2>Forensic Workflows</h2>
                <div class="command-block">
                    <h3>Complete Disk Analysis</h3>
                    <pre><code>#!/bin/bash
# Complete forensic carving workflow

DISK_IMAGE="$1"
OUTPUT_BASE="$2"

if [ $# -ne 2 ]; then
    echo "Usage: $0 <disk_image> <output_base_directory>"
    exit 1
fi

mkdir -p "$OUTPUT_BASE"

echo "Starting comprehensive file carving..."

# Phase 1: Common file types
echo "Phase 1: Common files"
foremost -d -w -t jpg,png,gif,pdf,doc,xls,zip,exe -i "$DISK_IMAGE" -o "$OUTPUT_BASE/common_files/"

# Phase 2: Multimedia files
echo "Phase 2: Multimedia files"
foremost -d -w -s 1073741824 -t avi,mov,mp4,wmv,wav,mp3 -i "$DISK_IMAGE" -o "$OUTPUT_BASE/multimedia/"

# Phase 3: All remaining types
echo "Phase 3: All file types"
foremost -d -w -a -i "$DISK_IMAGE" -o "$OUTPUT_BASE/all_types/"

# Generate summary report
echo "=== File Carving Summary ===" > "$OUTPUT_BASE/carving_summary.txt"
echo "Disk Image: $DISK_IMAGE" >> "$OUTPUT_BASE/carving_summary.txt"
echo "Analysis Date: $(date)" >> "$OUTPUT_BASE/carving_summary.txt"
echo "" >> "$OUTPUT_BASE/carving_summary.txt"

for dir in "$OUTPUT_BASE"/*/; do
    if [ -f "$dir/audit.txt" ]; then
        echo "=== $(basename "$dir") ===" >> "$OUTPUT_BASE/carving_summary.txt"
        cat "$dir/audit.txt" >> "$OUTPUT_BASE/carving_summary.txt"
        echo "" >> "$OUTPUT_BASE/carving_summary.txt"
    fi
done

echo "Carving completed. Results in $OUTPUT_BASE"</code></pre>
                </div>
                <div class="command-block">
                    <h3>Targeted Recovery Script</h3>
                    <pre><code>#!/bin/bash
# Targeted file recovery based on case requirements

IMAGE="$1"
CASE_TYPE="$2"
OUTPUT="$3"

case "$CASE_TYPE" in
    "financial")
        echo "Recovering financial documents..."
        foremost -d -w -t pdf,doc,xls,csv -i "$IMAGE" -o "$OUTPUT/financial/"
        ;;
    "multimedia")
        echo "Recovering multimedia evidence..."
        foremost -d -w -s 2147483648 -t jpg,png,avi,mov,mp4 -i "$IMAGE" -o "$OUTPUT/multimedia/"
        ;;
    "communications")
        echo "Recovering communication files..."
        foremost -c email_recovery.conf -i "$IMAGE" -o "$OUTPUT/emails/"
        foremost -t htm,txt -i "$IMAGE" -o "$OUTPUT/text/"
        ;;
    "malware")
        echo "Recovering executable files..."
        foremost -d -w -t exe,dll,bat,cmd -i "$IMAGE" -o "$OUTPUT/executables/"
        ;;
    *)
        echo "Unknown case type. Performing general recovery..."
        foremost -d -w -a -i "$IMAGE" -o "$OUTPUT/general/"
        ;;
esac</code></pre>
                </div>
            </section>

            <section id="analysis-validation">
                <h2>Analysis & Validation</h2>
                <div class="command-block">
                    <h3>Validating Recovered Files</h3>
                    <pre><code># Check file integrity
file output_directory/*/*.jpg
file output_directory/*/*.pdf

# Validate image files
identify output_directory/jpg/*.jpg
identify output_directory/png/*.png

# Check PDF files
pdfinfo output_directory/pdf/*.pdf

# Validate executables
objdump -f output_directory/exe/*.exe</code></pre>
                </div>
                <div class="command-block">
                    <h3>Statistical Analysis</h3>
                    <pre><code>#!/bin/bash
# Analyze carving results

OUTPUT_DIR="$1"

echo "=== File Recovery Statistics ==="
echo "Analysis Date: $(date)"
echo ""

for type_dir in "$OUTPUT_DIR"/*/; do
    if [ -d "$type_dir" ] && [ "$(basename "$type_dir")" != "audit.txt" ]; then
        type_name=$(basename "$type_dir")
        file_count=$(find "$type_dir" -type f ! -name "audit.txt" | wc -l)
        total_size=$(find "$type_dir" -type f ! -name "audit.txt" -exec du -cb {} + | tail -1 | cut -f1)
        
        echo "File Type: $type_name"
        echo "  Files Recovered: $file_count"
        echo "  Total Size: $(numfmt --to=iec-i --suffix=B $total_size)"
        
        if [ -f "$type_dir/audit.txt" ]; then
            echo "  Audit Summary:"
            grep -E "(FILES EXTRACTED|SIZE)" "$type_dir/audit.txt" | sed 's/^/    /'
        fi
        echo ""
    fi
done</code></pre>
                </div>
                <div class="command-block">
                    <h3>Quality Assessment</h3>
                    <pre><code># Assess recovery quality
#!/bin/bash

RECOVERY_DIR="$1"

echo "=== Recovery Quality Assessment ==="

# Check for corrupted files
echo "Checking for corrupted files..."
find "$RECOVERY_DIR" -name "*.jpg" -exec jpeginfo -c {} \; | grep -i error
find "$RECOVERY_DIR" -name "*.png" -exec pngcheck {} \; | grep -i error

# Check file sizes
echo "Analyzing file sizes..."
find "$RECOVERY_DIR" -type f -exec ls -lh {} \; | awk '{print $5, $9}' | sort -hr | head -20

# Identify potentially incomplete files
echo "Checking for potentially incomplete files..."
find "$RECOVERY_DIR" -type f -size -1k -exec ls -lh {} \;</code></pre>
                </div>
            </section>

            <section id="integration">
                <h2>Integration with Other Tools</h2>
                <div class="command-block">
                    <h3>Integration with The Sleuth Kit</h3>
                    <pre><code># Extract unallocated space with TSK, then carve
blkls disk_image.dd > unallocated.dd
foremost -d -w -i unallocated.dd -o carved_from_unallocated/

# Carve from specific partitions
mmls disk_image.dd  # Get partition layout
dd if=disk_image.dd of=partition1.dd skip=63 count=204800
foremost -i partition1.dd -o partition1_carved/</code></pre>
                </div>
                <div class="command-block">
                    <h3>Integration with Scalpel</h3>
                    <pre><code># Use Foremost for initial carving, Scalpel for refinement
foremost -q -i disk.dd -o foremost_results/
scalpel -b -o scalpel_results/ disk.dd

# Compare results
diff -r foremost_results/ scalpel_results/</code></pre>
                </div>
                <div class="command-block">
                    <h3>Integration with Autopsy</h3>
                    <pre><code># Export unallocated space from Autopsy
# Use Autopsy's "Export Files" feature to get unallocated space
# Then carve with Foremost

foremost -d -w -i autopsy_unallocated.dd -o autopsy_carved/

# Import carved files back into Autopsy as logical files</code></pre>
                </div>
            </section>

            <section id="troubleshooting">
                <h2>Troubleshooting</h2>
                <div class="command-block">
                    <h3>Common Issues</h3>
                    <pre><code># Permission denied errors
sudo foremost -i /dev/sdb1 -o output/
# or
sudo chown $USER:$USER disk_image.dd

# Out of disk space
df -h  # Check available space
du -sh output_directory/  # Check output size

# Configuration file errors
foremost -c /etc/foremost.conf -i test.dd -o test_output/
# Check config file syntax

# Memory issues with large files
# Reduce maximum file size
foremost -s 104857600 -i large_image.dd -o output/</code></pre>
                </div>
                <div class="command-block">
                    <h3>Performance Issues</h3>
                    <pre><code># Speed up carving
# Use SSD for output directory
# Process smaller chunks
split -b 1G large_image.dd chunk_
for chunk in chunk_*; do
    foremost -i "$chunk" -o "output_$chunk/"
done

# Parallel processing
ls chunk_* | xargs -n 1 -P 4 -I {} foremost -i {} -o output_{}/</code></pre>
                </div>
            </section>

            <section id="use-cases">
                <h2>Common Use Cases</h2>
                <div class="command-block">
                    <h3>Digital Forensics</h3>
                    <ul>
                        <li>Recovering deleted files from disk images</li>
                        <li>Extracting evidence from damaged storage devices</li>
                        <li>Carving files from unallocated disk space</li>
                        <li>Recovering multimedia evidence</li>
                        <li>Extracting documents from corrupted file systems</li>
                    </ul>
                </div>
                <div class="command-block">
                    <h3>Data Recovery</h3>
                    <ul>
                        <li>Recovering photos from formatted memory cards</li>
                        <li>Extracting files from corrupted hard drives</li>
                        <li>Recovering documents after accidental deletion</li>
                        <li>Salvaging data from damaged storage media</li>
                        <li>Extracting files from RAW disk images</li>
                    </ul>
                </div>
                <div class="command-block">
                    <h3>Incident Response</h3>
                    <ul>
                        <li>Recovering malware samples</li>
                        <li>Extracting communication evidence</li>
                        <li>Carving log files and system artifacts</li>
                        <li>Recovering encrypted or hidden files</li>
                        <li>Extracting timeline evidence</li>
                    </ul>
                </div>
            </section>

            <section id="tips">
                <h2>Pro Tips & Best Practices</h2>
                <ul>
                    <li><strong>Use quality options:</strong> Always use -d and -w flags for better results</li>
                    <li><strong>Validate results:</strong> Check recovered files for integrity and completeness</li>
                    <li><strong>Custom configurations:</strong> Create specialized configs for specific file types</li>
                    <li><strong>Monitor disk space:</strong> Carving can generate large amounts of data</li>
                    <li><strong>Document everything:</strong> Keep detailed logs of carving operations</li>
                    <li><strong>Combine with other tools:</strong> Use TSK, Scalpel, and other tools for comprehensive analysis</li>
                    <li><strong>Test configurations:</strong> Validate custom configs on known data first</li>
                    <li><strong>Preserve originals:</strong> Always work with copies of evidence</li>
                </ul>
            </section>

            <section id="legal-disclaimer">
                <h2>Legal Disclaimer</h2>
                <div class="command-block">
                    <p><strong>WARNING:</strong> Foremost should only be used for:</p>
                    <ul>
                        <li>Recovering data from your own storage devices</li>
                        <li>Authorized forensic investigations with proper legal authority</li>
                        <li>Corporate data recovery with appropriate authorization</li>
                        <li>Academic research with proper permissions</li>
                        <li>Educational purposes in controlled environments</li>
                    </ul>
                    <p>Unauthorized data recovery or file carving may violate computer crime laws, privacy statutes, and other regulations. Digital forensics and data recovery should only be performed by qualified professionals with proper legal authority. Always ensure compliance with applicable laws, regulations, and organizational policies. Recovered data may contain sensitive or personal information that must be handled according to applicable privacy laws and data protection requirements.</p>
                </div>
            </section>
        </main>
    </div>
</body>
</html>
